import * as tslib_1 from "tslib";
import { Inject, Injectable, InjectionToken, NgModule, } from '@angular/core';
import Perfume from 'perfume.js';
export var perfume;
export var PERFUME_CONFIG = new InjectionToken('Perfume.js config');
var PerfumeRootModule = /** @class */ (function () {
    function PerfumeRootModule(config) {
        this.config = config;
        perfume = new Perfume(config);
    }
    PerfumeRootModule.decorators = [
        { type: NgModule, args: [{},] }
    ];
    /** @nocollapse */
    PerfumeRootModule.ctorParameters = function () { return [
        { type: undefined, decorators: [{ type: Inject, args: [PERFUME_CONFIG,] }] }
    ]; };
    return PerfumeRootModule;
}());
export { PerfumeRootModule };
var NgPerfume = /** @class */ (function () {
    function NgPerfume() {
        this.firstPaintDuration = 0;
        this.firstContentfulPaintDuration = 0;
        this.firstInputDelayDuration = 0;
        this.timeToInteractiveDuration = 0;
        this.config = perfume.config;
        this.firstPaintDuration = perfume.firstPaintDuration;
        this.firstContentfulPaintDuration = perfume.firstContentfulPaintDuration;
        this.firstInputDelayDuration = perfume.firstInputDelayDuration;
        this.observeFirstContentfulPaint = perfume.observeFirstContentfulPaint;
        this.observeFirstInputDelay = perfume.observeFirstInputDelay;
        this.observeTimeToInteractive = perfume.observeTimeToInteractive;
        this.timeToInteractiveDuration = perfume.timeToInteractiveDuration;
    }
    NgPerfume.prototype.start = function (metricName) {
        perfume.start(metricName);
    };
    NgPerfume.prototype.end = function (metricName) {
        return perfume.end(metricName);
    };
    NgPerfume.prototype.endPaint = function (metricName) {
        return perfume.endPaint(metricName);
    };
    NgPerfume.prototype.log = function (metricName, duration) {
        perfume.log(metricName, duration);
    };
    NgPerfume.prototype.sendTiming = function (metricName, duration) {
        perfume.sendTiming(metricName, duration);
    };
    NgPerfume.decorators = [
        { type: Injectable }
    ];
    /** @nocollapse */
    NgPerfume.ctorParameters = function () { return []; };
    return NgPerfume;
}());
export { NgPerfume };
var PerfumeModule = /** @class */ (function () {
    function PerfumeModule() {
    }
    PerfumeModule.forRoot = function (config) {
        return {
            ngModule: PerfumeRootModule,
            providers: [
                {
                    provide: PERFUME_CONFIG,
                    useValue: config,
                },
                NgPerfume,
            ],
        };
    };
    PerfumeModule.decorators = [
        { type: NgModule, args: [{
                    imports: [],
                    declarations: [],
                    exports: [],
                },] }
    ];
    return PerfumeModule;
}());
export { PerfumeModule };
/**
 * Component View Init (CVI) decorator
 * Marks the time between the constructor is initialized,
 * and ngAfterViewInit execution ends.
 */
// tslint:disable-next-line:function-name
export function PerfumeAfterViewInit(targetName) {
    return function DecoratorFactory(target) {
        // The new constructor behavior, supports AOT and DI
        var newConstructor = function newCtor() {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            perfume.start(targetName || target.name);
            var c = function childConstuctor() {
                return target.apply(this, arguments);
            };
            c.prototype = Object.create(target.prototype);
            return new (c.bind.apply(c, tslib_1.__spread([void 0], args)))();
        };
        // The new ngAfterViewInit behavior
        var ngAfterViewInit = target.prototype.ngAfterViewInit;
        target.prototype.ngAfterViewInit = function () {
            var args = [];
            for (var _i = 0; _i < arguments.length; _i++) {
                args[_i] = arguments[_i];
            }
            // tslint:disable-next-line:no-unused-expression
            ngAfterViewInit && ngAfterViewInit.apply(this, args);
            perfume.end(targetName || target.name);
        };
        // Copy prototype so instanceof operator still works
        newConstructor.prototype = Object.create(target.prototype);
        // Return new constructor (will override original)
        return newConstructor;
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGVyZnVtZS5tb2R1bGUuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9wZXJmdW1lLmpzL2FuZ3VsYXIvIiwic291cmNlcyI6WyJsaWIvcGVyZnVtZS5tb2R1bGUudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLE9BQU8sRUFFTCxNQUFNLEVBQ04sVUFBVSxFQUNWLGNBQWMsRUFFZCxRQUFRLEdBQ1QsTUFBTSxlQUFlLENBQUM7QUFDdkIsT0FBTyxPQUEyQixNQUFNLFlBQVksQ0FBQztBQUVyRCxNQUFNLENBQUMsSUFBSSxPQUFPLENBQUM7QUFFbkIsTUFBTSxDQUFDLElBQU0sY0FBYyxHQUFHLElBQUksY0FBYyxDQUFDLG1CQUFtQixDQUFDLENBQUM7QUFFdEU7SUFFRSwyQkFBMkMsTUFBc0I7UUFBdEIsV0FBTSxHQUFOLE1BQU0sQ0FBZ0I7UUFDL0QsT0FBTyxHQUFHLElBQUksT0FBTyxDQUFDLE1BQU0sQ0FBQyxDQUFDO0lBQ2hDLENBQUM7O2dCQUpGLFFBQVEsU0FBQyxFQUFFOzs7O2dEQUVHLE1BQU0sU0FBQyxjQUFjOztJQUdwQyx3QkFBQztDQUFBLEFBTEQsSUFLQztTQUpZLGlCQUFpQjtBQU05QjtJQVlFO1FBUkEsdUJBQWtCLEdBQUcsQ0FBQyxDQUFDO1FBQ3ZCLGlDQUE0QixHQUFHLENBQUMsQ0FBQztRQUNqQyw0QkFBdUIsR0FBRyxDQUFDLENBQUM7UUFJNUIsOEJBQXlCLEdBQUcsQ0FBQyxDQUFDO1FBRzVCLElBQUksQ0FBQyxNQUFNLEdBQUcsT0FBTyxDQUFDLE1BQU0sQ0FBQztRQUM3QixJQUFJLENBQUMsa0JBQWtCLEdBQUcsT0FBTyxDQUFDLGtCQUFrQixDQUFDO1FBQ3JELElBQUksQ0FBQyw0QkFBNEIsR0FBRyxPQUFPLENBQUMsNEJBQTRCLENBQUM7UUFDekUsSUFBSSxDQUFDLHVCQUF1QixHQUFHLE9BQU8sQ0FBQyx1QkFBdUIsQ0FBQztRQUMvRCxJQUFJLENBQUMsMkJBQTJCLEdBQUcsT0FBTyxDQUFDLDJCQUEyQixDQUFDO1FB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LFNBQVMsR0FBRyxNQUFNLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUUzRCxrREFBa0Q7UUFDbEQsT0FBTyxjQUFjLENBQUM7SUFDeEIsQ0FBQyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XG4gIEFmdGVyVmlld0luaXQsXG4gIEluamVjdCxcbiAgSW5qZWN0YWJsZSxcbiAgSW5qZWN0aW9uVG9rZW4sXG4gIE1vZHVsZVdpdGhQcm92aWRlcnMsXG4gIE5nTW9kdWxlLFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCBQZXJmdW1lLCB7IElQZXJmdW1lQ29uZmlnIH0gZnJvbSAncGVyZnVtZS5qcyc7XG5cbmV4cG9ydCBsZXQgcGVyZnVtZTtcblxuZXhwb3J0IGNvbnN0IFBFUkZVTUVfQ09ORklHID0gbmV3IEluamVjdGlvblRva2VuKCdQZXJmdW1lLmpzIGNvbmZpZycpO1xuXG5ATmdNb2R1bGUoe30pXG5leHBvcnQgY2xhc3MgUGVyZnVtZVJvb3RNb2R1bGUge1xuICBjb25zdHJ1Y3RvcihASW5qZWN0KFBFUkZVTUVfQ09ORklHKSBwdWJsaWMgY29uZmlnOiBJUGVyZnVtZUNvbmZpZykge1xuICAgIHBlcmZ1bWUgPSBuZXcgUGVyZnVtZShjb25maWcpO1xuICB9XG59XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBOZ1BlcmZ1bWUge1xuICBwZXJmdW1lOiBQZXJmdW1lO1xuICBjb25maWc6IElQZXJmdW1lQ29uZmlnO1xuICBmaXJzdFBhaW50RHVyYXRpb24gPSAwO1xuICBmaXJzdENvbnRlbnRmdWxQYWludER1cmF0aW9uID0gMDtcbiAgZmlyc3RJbnB1dERlbGF5RHVyYXRpb24gPSAwO1xuICBvYnNlcnZlRmlyc3RDb250ZW50ZnVsUGFpbnQ6IFByb21pc2U8bnVtYmVyPjtcbiAgb2JzZXJ2ZUZpcnN0SW5wdXREZWxheTogUHJvbWlzZTxudW1iZXI+O1xuICBvYnNlcnZlVGltZVRvSW50ZXJhY3RpdmU/OiBQcm9taXNlPG51bWJlcj47XG4gIHRpbWVUb0ludGVyYWN0aXZlRHVyYXRpb24gPSAwO1xuXG4gIGNvbnN0cnVjdG9yKCkge1xuICAgIHRoaXMuY29uZmlnID0gcGVyZnVtZS5jb25maWc7XG4gICAgdGhpcy5maXJzdFBhaW50RHVyYXRpb24gPSBwZXJmdW1lLmZpcnN0UGFpbnREdXJhdGlvbjtcbiAgICB0aGlzLmZpcnN0Q29udGVudGZ1bFBhaW50RHVyYXRpb24gPSBwZXJmdW1lLmZpcnN0Q29udGVudGZ1bFBhaW50RHVyYXRpb247XG4gICAgdGhpcy5maXJzdElucHV0RGVsYXlEdXJhdGlvbiA9IHBlcmZ1bWUuZmlyc3RJbnB1dERlbGF5RHVyYXRpb247XG4gICAgdGhpcy5vYnNlcnZlRmlyc3RDb250ZW50ZnVsUGFpbnQgPSBwZXJmdW1lLm9ic2VydmVGaXJzdENvbnRlbnRmdWxQYWludDtcbiAgICB0aGlzLm9ic2VydmVGaXJzdElucHV0RGVsYXkgPSBwZXJmdW1lLm9ic2VydmVGaXJzdElucHV0RGVsYXk7XG4gICAgdGhpcy5vYnNlcnZlVGltZVRvSW50ZXJhY3RpdmUgPSBwZXJmdW1lLm9ic2VydmVUaW1lVG9JbnRlcmFjdGl2ZTtcbiAgICB0aGlzLnRpbWVUb0ludGVyYWN0aXZlRHVyYXRpb24gPSBwZXJmdW1lLnRpbWVUb0ludGVyYWN0aXZlRHVyYXRpb247XG4gIH1cblxuICBzdGFydChtZXRyaWNOYW1lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICBwZXJmdW1lLnN0YXJ0KG1ldHJpY05hbWUpO1xuICB9XG5cbiAgZW5kKG1ldHJpY05hbWU6IHN0cmluZyk6IHZvaWQgfCBudW1iZXIge1xuICAgIHJldHVybiBwZXJmdW1lLmVuZChtZXRyaWNOYW1lKTtcbiAgfVxuXG4gIGVuZFBhaW50KG1ldHJpY05hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZCB8IG51bWJlcj4ge1xuICAgIHJldHVybiBwZXJmdW1lLmVuZFBhaW50KG1ldHJpY05hbWUpO1xuICB9XG5cbiAgbG9nKG1ldHJpY05hbWU6IHN0cmluZywgZHVyYXRpb246IG51bWJlcik6IHZvaWQge1xuICAgIHBlcmZ1bWUubG9nKG1ldHJpY05hbWUsIGR1cmF0aW9uKTtcbiAgfVxuXG4gIHNlbmRUaW1pbmcobWV0cmljTmFtZTogc3RyaW5nLCBkdXJhdGlvbjogbnVtYmVyKTogdm9pZCB7XG4gICAgcGVyZnVtZS5zZW5kVGltaW5nKG1ldHJpY05hbWUsIGR1cmF0aW9uKTtcbiAgfVxufVxuXG5ATmdNb2R1bGUoe1xuICBpbXBvcnRzOiBbXSxcbiAgZGVjbGFyYXRpb25zOiBbXSxcbiAgZXhwb3J0czogW10sXG59KVxuZXhwb3J0IGNsYXNzIFBlcmZ1bWVNb2R1bGUge1xuICBwdWJsaWMgc3RhdGljIGZvclJvb3QoY29uZmlnOiBhbnkpOiBNb2R1bGVXaXRoUHJvdmlkZXJzIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmdNb2R1bGU6IFBlcmZ1bWVSb290TW9kdWxlLFxuICAgICAgcHJvdmlkZXJzOiBbXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlOiBQRVJGVU1FX0NPTkZJRyxcbiAgICAgICAgICB1c2VWYWx1ZTogY29uZmlnLFxuICAgICAgICB9LFxuICAgICAgICBOZ1BlcmZ1bWUsXG4gICAgICBdLFxuICAgIH07XG4gIH1cbn1cblxuLyoqXG4gKiBEZXNjcmliZXMgYW55IEFuZ3VsYXIgY29tcG9uZW50IGNsYXNzIHRoYXQgaW1wbGVtZW50cyBgQWZ0ZXJWaWV3SW5pdGAuXG4gKi9cbi8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTppbnRlcmZhY2UtbmFtZVxuZXhwb3J0IGludGVyZmFjZSBBZnRlclZpZXdJbml0YWJsZSB7XG4gIHByb3RvdHlwZTogQWZ0ZXJWaWV3SW5pdDtcbiAgbmV3ICguLi5hcmdzOiBhbnlbXSk6IEFmdGVyVmlld0luaXQ7XG59XG5cbi8qKlxuICogQ29tcG9uZW50IFZpZXcgSW5pdCAoQ1ZJKSBkZWNvcmF0b3JcbiAqIE1hcmtzIHRoZSB0aW1lIGJldHdlZW4gdGhlIGNvbnN0cnVjdG9yIGlzIGluaXRpYWxpemVkLFxuICogYW5kIG5nQWZ0ZXJWaWV3SW5pdCBleGVjdXRpb24gZW5kcy5cbiAqL1xuLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lOmZ1bmN0aW9uLW5hbWVcbmV4cG9ydCBmdW5jdGlvbiBQZXJmdW1lQWZ0ZXJWaWV3SW5pdCh0YXJnZXROYW1lPzogc3RyaW5nKSB7XG4gIHJldHVybiBmdW5jdGlvbiBEZWNvcmF0b3JGYWN0b3J5KHRhcmdldDogQWZ0ZXJWaWV3SW5pdGFibGUpIHtcbiAgICAvLyBUaGUgbmV3IGNvbnN0cnVjdG9yIGJlaGF2aW9yLCBzdXBwb3J0cyBBT1QgYW5kIERJXG4gICAgY29uc3QgbmV3Q29uc3RydWN0b3I6IGFueSA9IGZ1bmN0aW9uIG5ld0N0b3IoLi4uYXJncykge1xuICAgICAgcGVyZnVtZS5zdGFydCh0YXJnZXROYW1lIHx8IHRhcmdldC5uYW1lKTtcbiAgICAgIGNvbnN0IGM6IGFueSA9IGZ1bmN0aW9uIGNoaWxkQ29uc3R1Y3RvcigpIHtcbiAgICAgICAgcmV0dXJuIHRhcmdldC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICAgIGMucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSh0YXJnZXQucHJvdG90eXBlKTtcbiAgICAgIHJldHVybiBuZXcgYyguLi5hcmdzKTtcbiAgICB9O1xuXG4gICAgLy8gVGhlIG5ldyBuZ0FmdGVyVmlld0luaXQgYmVoYXZpb3JcbiAgICBjb25zdCBuZ0FmdGVyVmlld0luaXQgPSB0YXJnZXQucHJvdG90eXBlLm5nQWZ0ZXJWaWV3SW5pdDtcbiAgICB0YXJnZXQucHJvdG90eXBlLm5nQWZ0ZXJWaWV3SW5pdCA9IGZ1bmN0aW9uKC4uLmFyZ3MpIHtcbiAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZTpuby11bnVzZWQtZXhwcmVzc2lvblxuICAgICAgbmdBZnRlclZpZXdJbml0ICYmIG5nQWZ0ZXJWaWV3SW5pdC5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgIHBlcmZ1bWUuZW5kKHRhcmdldE5hbWUgfHwgdGFyZ2V0Lm5hbWUpO1xuICAgIH07XG5cbiAgICAvLyBDb3B5IHByb3RvdHlwZSBzbyBpbnN0YW5jZW9mIG9wZXJhdG9yIHN0aWxsIHdvcmtzXG4gICAgbmV3Q29uc3RydWN0b3IucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSh0YXJnZXQucHJvdG90eXBlKTtcblxuICAgIC8vIFJldHVybiBuZXcgY29uc3RydWN0b3IgKHdpbGwgb3ZlcnJpZGUgb3JpZ2luYWwpXG4gICAgcmV0dXJuIG5ld0NvbnN0cnVjdG9yO1xuICB9O1xufVxuIl19