(function (global, factory) {
    typeof exports === 'object' && typeof module !== 'undefined' ? factory(exports, require('@angular/core'), require('apollo-link'), require('apollo-angular'), require('apollo-angular-link-http'), require('apollo-link-state'), require('apollo-link-error'), require('apollo-cache-inmemory'), require('graphql-tag'), require('apollo-client')) :
    typeof define === 'function' && define.amd ? define('apollo-angular-boost', ['exports', '@angular/core', 'apollo-link', 'apollo-angular', 'apollo-angular-link-http', 'apollo-link-state', 'apollo-link-error', 'apollo-cache-inmemory', 'graphql-tag', 'apollo-client'], factory) :
    (factory((global['apollo-angular-boost'] = {}),global.ng.core,global.apolloLink.core,global.ng.apollo,global.ng.apolloLink.http,global.apolloLink.state,global.apolloLink.error,global.apollo.cache.inmemory,global.graphqlTag,global.apollo));
}(this, (function (exports,core,apolloLink,apolloAngular,apolloAngularLinkHttp,apolloLinkState,apolloLinkError,apolloCacheInmemory,graphqlTag,apolloClient) { 'use strict';

    graphqlTag = graphqlTag && graphqlTag.hasOwnProperty('default') ? graphqlTag['default'] : graphqlTag;
    var apolloClient__default = 'default' in apolloClient ? apolloClient['default'] : apolloClient;

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    /** @type {?} */
    var APOLLO_BOOST_CONFIG = new core.InjectionToken('[apollo-angular-boost] config');

    /*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */
    var __assign = function () {
        __assign = Object.assign || function __assign(t) {
            for (var s, i = 1, n = arguments.length; i < n; i++) {
                s = arguments[i];
                for (var p in s)
                    if (Object.prototype.hasOwnProperty.call(s, p))
                        t[p] = s[p];
            }
            return t;
        };
        return __assign.apply(this, arguments);
    };

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var ApolloBoost = /** @class */ (function () {
        function ApolloBoost(apollo, httpLink) {
            this.apollo = apollo;
            this.httpLink = httpLink;
        }
        /**
         * @param {?} config
         * @return {?}
         */
        ApolloBoost.prototype.create = /**
         * @param {?} config
         * @return {?}
         */
            function (config) {
                /** @type {?} */
                var cache = config && config.cacheRedirects
                    ? new apolloCacheInmemory.InMemoryCache({ cacheRedirects: config.cacheRedirects })
                    : new apolloCacheInmemory.InMemoryCache();
                /** @type {?} */
                var stateLink = config && config.clientState
                    ? apolloLinkState.withClientState(__assign({}, config.clientState, { cache: cache }))
                    : false;
                /** @type {?} */
                var errorLink = config && config.onError
                    ? apolloLinkError.onError(config.onError)
                    : apolloLinkError.onError(function (_a) {
                        var graphQLErrors = _a.graphQLErrors, networkError = _a.networkError;
                        if (graphQLErrors) {
                            graphQLErrors.map(function (_a) {
                                var message = _a.message, locations = _a.locations, path = _a.path;
                                // tslint:disable-next-line
                                return console.log("[GraphQL error]: Message: " + message + ", Location: " + locations + ", Path: " + path);
                            });
                        }
                        if (networkError) {
                            // tslint:disable-next-line
                            console.log("[Network error]: " + networkError);
                        }
                    });
                /** @type {?} */
                var requestHandler = config && config.request
                    ? new apolloLink.ApolloLink(function (operation, forward) {
                        return new apolloLink.Observable(function (observer) {
                            /** @type {?} */
                            var handle;
                            Promise.resolve(operation)
                                .then(function (oper) { return config.request(oper); })
                                .then(function () {
                                handle = forward(operation).subscribe({
                                    next: observer.next.bind(observer),
                                    error: observer.error.bind(observer),
                                    complete: observer.complete.bind(observer),
                                });
                            })
                                .catch(observer.error.bind(observer));
                            return function () {
                                if (handle) {
                                    handle.unsubscribe();
                                }
                            };
                        });
                    })
                    : false;
                /** @type {?} */
                var httpLink = this.httpLink.create(__assign({}, ((config && config.httpOptions) || {}), { uri: (config && config.uri) || '/graphql' }));
                /** @type {?} */
                var link = apolloLink.ApolloLink.from(( /** @type {?} */([
                    errorLink,
                    requestHandler,
                    stateLink,
                    httpLink,
                ].filter(function (x) { return !!x; }))));
                this.apollo.create({
                    link: link,
                    cache: cache,
                });
            };
        ApolloBoost.decorators = [
            { type: core.Injectable }
        ];
        /** @nocollapse */
        ApolloBoost.ctorParameters = function () {
            return [
                { type: apolloAngular.Apollo },
                { type: apolloAngularLinkHttp.HttpLink }
            ];
        };
        return ApolloBoost;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */
    var ApolloBoostModule = /** @class */ (function () {
        function ApolloBoostModule(boost, config) {
            if (config) {
                boost.create(config);
            }
        }
        ApolloBoostModule.decorators = [
            { type: core.NgModule, args: [{
                        imports: [apolloAngular.ApolloModule, apolloAngularLinkHttp.HttpLinkModule],
                        providers: [ApolloBoost],
                    },] }
        ];
        /** @nocollapse */
        ApolloBoostModule.ctorParameters = function () {
            return [
                { type: ApolloBoost },
                { type: undefined, decorators: [{ type: core.Optional }, { type: core.Inject, args: [APOLLO_BOOST_CONFIG,] }] }
            ];
        };
        return ApolloBoostModule;
    }());

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    /**
     * @fileoverview added by tsickle
     * @suppress {checkTypes,extraRequire,uselessCode} checked by tsc
     */

    exports.createOperation = apolloLink.createOperation;
    exports.makePromise = apolloLink.makePromise;
    exports.toPromise = apolloLink.toPromise;
    exports.fromPromise = apolloLink.fromPromise;
    exports.fromError = apolloLink.fromError;
    exports.Observable = apolloLink.Observable;
    exports.execute = apolloLink.execute;
    exports.empty = apolloLink.empty;
    exports.from = apolloLink.from;
    exports.split = apolloLink.split;
    exports.concat = apolloLink.concat;
    exports.ApolloLink = apolloLink.ApolloLink;
    exports.ɵb = apolloAngular.ɵb;
    exports.ɵa = apolloAngular.ɵa;
    exports.Apollo = apolloAngular.Apollo;
    exports.ApolloBase = apolloAngular.ApolloBase;
    exports.QueryRef = apolloAngular.QueryRef;
    exports.Query = apolloAngular.Query;
    exports.Mutation = apolloAngular.Mutation;
    exports.Subscription = apolloAngular.Subscription;
    exports.SelectPipe = apolloAngular.SelectPipe;
    exports.ApolloModule = apolloAngular.ApolloModule;
    exports.APOLLO_OPTIONS = apolloAngular.APOLLO_OPTIONS;
    exports.InMemoryCache = apolloCacheInmemory.InMemoryCache;
    exports.defaultDataIdFromObject = apolloCacheInmemory.defaultDataIdFromObject;
    exports.assertIdValue = apolloCacheInmemory.assertIdValue;
    exports.StoreReader = apolloCacheInmemory.StoreReader;
    exports.enhanceErrorWithDocument = apolloCacheInmemory.enhanceErrorWithDocument;
    exports.WriteError = apolloCacheInmemory.WriteError;
    exports.StoreWriter = apolloCacheInmemory.StoreWriter;
    exports.HeuristicFragmentMatcher = apolloCacheInmemory.HeuristicFragmentMatcher;
    exports.IntrospectionFragmentMatcher = apolloCacheInmemory.IntrospectionFragmentMatcher;
    exports.defaultNormalizedCacheFactory = apolloCacheInmemory.defaultNormalizedCacheFactory;
    exports.ObjectCache = apolloCacheInmemory.ObjectCache;
    exports.record = apolloCacheInmemory.record;
    exports.RecordingCache = apolloCacheInmemory.RecordingCache;
    exports.gql = graphqlTag;
    exports.printAST = apolloClient.printAST;
    exports.ObservableQuery = apolloClient.ObservableQuery;
    exports.NetworkStatus = apolloClient.NetworkStatus;
    exports.ApolloError = apolloClient.ApolloError;
    exports.ApolloClient = apolloClient.ApolloClient;
    exports.FetchType = apolloClient.FetchType;
    exports.APOLLO_BOOST_CONFIG = APOLLO_BOOST_CONFIG;
    exports.ApolloBoost = ApolloBoost;
    exports.ApolloBoostModule = ApolloBoostModule;

    Object.defineProperty(exports, '__esModule', { value: true });

})));

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmcuYXBvbGxvQm9vc3QudW1kLmpzLm1hcCIsInNvdXJjZXMiOlsibmc6Ly9hcG9sbG8tYW5ndWxhci1ib29zdC90b2tlbnMudHMiLCIuLi8uLi9ub2RlX21vZHVsZXMvdHNsaWIvdHNsaWIuZXM2LmpzIiwibmc6Ly9hcG9sbG8tYW5ndWxhci1ib29zdC9BcG9sbG9Cb29zdC50cyIsIm5nOi8vYXBvbGxvLWFuZ3VsYXItYm9vc3QvQXBvbGxvQm9vc3RNb2R1bGUudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtJbmplY3Rpb25Ub2tlbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5cbmltcG9ydCB7UHJlc2V0Q29uZmlnfSBmcm9tICcuL3R5cGVzJztcblxuZXhwb3J0IGNvbnN0IEFQT0xMT19CT09TVF9DT05GSUcgPSBuZXcgSW5qZWN0aW9uVG9rZW48UHJlc2V0Q29uZmlnPihcbiAgJ1thcG9sbG8tYW5ndWxhci1ib29zdF0gY29uZmlnJyxcbik7XG4iLCIvKiEgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKipcclxuQ29weXJpZ2h0IChjKSBNaWNyb3NvZnQgQ29ycG9yYXRpb24uIEFsbCByaWdodHMgcmVzZXJ2ZWQuXHJcbkxpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7IHlvdSBtYXkgbm90IHVzZVxyXG50aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS4gWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZVxyXG5MaWNlbnNlIGF0IGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG5cclxuVEhJUyBDT0RFIElTIFBST1ZJREVEIE9OIEFOICpBUyBJUyogQkFTSVMsIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWVxyXG5LSU5ELCBFSVRIRVIgRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgV0lUSE9VVCBMSU1JVEFUSU9OIEFOWSBJTVBMSUVEXHJcbldBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBUSVRMRSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UsXHJcbk1FUkNIQU5UQUJMSVRZIE9SIE5PTi1JTkZSSU5HRU1FTlQuXHJcblxyXG5TZWUgdGhlIEFwYWNoZSBWZXJzaW9uIDIuMCBMaWNlbnNlIGZvciBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnNcclxuYW5kIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiAqL1xyXG4vKiBnbG9iYWwgUmVmbGVjdCwgUHJvbWlzZSAqL1xyXG5cclxudmFyIGV4dGVuZFN0YXRpY3MgPSBmdW5jdGlvbihkLCBiKSB7XHJcbiAgICBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19leHRlbmRzKGQsIGIpIHtcclxuICAgIGV4dGVuZFN0YXRpY3MoZCwgYik7XHJcbiAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgIGQucHJvdG90eXBlID0gYiA9PT0gbnVsbCA/IE9iamVjdC5jcmVhdGUoYikgOiAoX18ucHJvdG90eXBlID0gYi5wcm90b3R5cGUsIG5ldyBfXygpKTtcclxufVxyXG5cclxuZXhwb3J0IHZhciBfX2Fzc2lnbiA9IGZ1bmN0aW9uKCkge1xyXG4gICAgX19hc3NpZ24gPSBPYmplY3QuYXNzaWduIHx8IGZ1bmN0aW9uIF9fYXNzaWduKHQpIHtcclxuICAgICAgICBmb3IgKHZhciBzLCBpID0gMSwgbiA9IGFyZ3VtZW50cy5sZW5ndGg7IGkgPCBuOyBpKyspIHtcclxuICAgICAgICAgICAgcyA9IGFyZ3VtZW50c1tpXTtcclxuICAgICAgICAgICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApKSB0W3BdID0gc1twXTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHQ7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gX19hc3NpZ24uYXBwbHkodGhpcywgYXJndW1lbnRzKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fcmVzdChzLCBlKSB7XHJcbiAgICB2YXIgdCA9IHt9O1xyXG4gICAgZm9yICh2YXIgcCBpbiBzKSBpZiAoT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHMsIHApICYmIGUuaW5kZXhPZihwKSA8IDApXHJcbiAgICAgICAgdFtwXSA9IHNbcF07XHJcbiAgICBpZiAocyAhPSBudWxsICYmIHR5cGVvZiBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzID09PSBcImZ1bmN0aW9uXCIpXHJcbiAgICAgICAgZm9yICh2YXIgaSA9IDAsIHAgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlTeW1ib2xzKHMpOyBpIDwgcC5sZW5ndGg7IGkrKykgaWYgKGUuaW5kZXhPZihwW2ldKSA8IDApXHJcbiAgICAgICAgICAgIHRbcFtpXV0gPSBzW3BbaV1dO1xyXG4gICAgcmV0dXJuIHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2RlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKSB7XHJcbiAgICB2YXIgYyA9IGFyZ3VtZW50cy5sZW5ndGgsIHIgPSBjIDwgMyA/IHRhcmdldCA6IGRlc2MgPT09IG51bGwgPyBkZXNjID0gT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcih0YXJnZXQsIGtleSkgOiBkZXNjLCBkO1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0LmRlY29yYXRlID09PSBcImZ1bmN0aW9uXCIpIHIgPSBSZWZsZWN0LmRlY29yYXRlKGRlY29yYXRvcnMsIHRhcmdldCwga2V5LCBkZXNjKTtcclxuICAgIGVsc2UgZm9yICh2YXIgaSA9IGRlY29yYXRvcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIGlmIChkID0gZGVjb3JhdG9yc1tpXSkgciA9IChjIDwgMyA/IGQocikgOiBjID4gMyA/IGQodGFyZ2V0LCBrZXksIHIpIDogZCh0YXJnZXQsIGtleSkpIHx8IHI7XHJcbiAgICByZXR1cm4gYyA+IDMgJiYgciAmJiBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBrZXksIHIpLCByO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19wYXJhbShwYXJhbUluZGV4LCBkZWNvcmF0b3IpIHtcclxuICAgIHJldHVybiBmdW5jdGlvbiAodGFyZ2V0LCBrZXkpIHsgZGVjb3JhdG9yKHRhcmdldCwga2V5LCBwYXJhbUluZGV4KTsgfVxyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19tZXRhZGF0YShtZXRhZGF0YUtleSwgbWV0YWRhdGFWYWx1ZSkge1xyXG4gICAgaWYgKHR5cGVvZiBSZWZsZWN0ID09PSBcIm9iamVjdFwiICYmIHR5cGVvZiBSZWZsZWN0Lm1ldGFkYXRhID09PSBcImZ1bmN0aW9uXCIpIHJldHVybiBSZWZsZWN0Lm1ldGFkYXRhKG1ldGFkYXRhS2V5LCBtZXRhZGF0YVZhbHVlKTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXdhaXRlcih0aGlzQXJnLCBfYXJndW1lbnRzLCBQLCBnZW5lcmF0b3IpIHtcclxuICAgIHJldHVybiBuZXcgKFAgfHwgKFAgPSBQcm9taXNlKSkoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xyXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGZpbGxlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvci5uZXh0KHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiByZWplY3RlZCh2YWx1ZSkgeyB0cnkgeyBzdGVwKGdlbmVyYXRvcltcInRocm93XCJdKHZhbHVlKSk7IH0gY2F0Y2ggKGUpIHsgcmVqZWN0KGUpOyB9IH1cclxuICAgICAgICBmdW5jdGlvbiBzdGVwKHJlc3VsdCkgeyByZXN1bHQuZG9uZSA/IHJlc29sdmUocmVzdWx0LnZhbHVlKSA6IG5ldyBQKGZ1bmN0aW9uIChyZXNvbHZlKSB7IHJlc29sdmUocmVzdWx0LnZhbHVlKTsgfSkudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsgfVxyXG4gICAgICAgIHN0ZXAoKGdlbmVyYXRvciA9IGdlbmVyYXRvci5hcHBseSh0aGlzQXJnLCBfYXJndW1lbnRzIHx8IFtdKSkubmV4dCgpKTtcclxuICAgIH0pO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19nZW5lcmF0b3IodGhpc0FyZywgYm9keSkge1xyXG4gICAgdmFyIF8gPSB7IGxhYmVsOiAwLCBzZW50OiBmdW5jdGlvbigpIHsgaWYgKHRbMF0gJiAxKSB0aHJvdyB0WzFdOyByZXR1cm4gdFsxXTsgfSwgdHJ5czogW10sIG9wczogW10gfSwgZiwgeSwgdCwgZztcclxuICAgIHJldHVybiBnID0geyBuZXh0OiB2ZXJiKDApLCBcInRocm93XCI6IHZlcmIoMSksIFwicmV0dXJuXCI6IHZlcmIoMikgfSwgdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIChnW1N5bWJvbC5pdGVyYXRvcl0gPSBmdW5jdGlvbigpIHsgcmV0dXJuIHRoaXM7IH0pLCBnO1xyXG4gICAgZnVuY3Rpb24gdmVyYihuKSB7IHJldHVybiBmdW5jdGlvbiAodikgeyByZXR1cm4gc3RlcChbbiwgdl0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzdGVwKG9wKSB7XHJcbiAgICAgICAgaWYgKGYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJHZW5lcmF0b3IgaXMgYWxyZWFkeSBleGVjdXRpbmcuXCIpO1xyXG4gICAgICAgIHdoaWxlIChfKSB0cnkge1xyXG4gICAgICAgICAgICBpZiAoZiA9IDEsIHkgJiYgKHQgPSBvcFswXSAmIDIgPyB5W1wicmV0dXJuXCJdIDogb3BbMF0gPyB5W1widGhyb3dcIl0gfHwgKCh0ID0geVtcInJldHVyblwiXSkgJiYgdC5jYWxsKHkpLCAwKSA6IHkubmV4dCkgJiYgISh0ID0gdC5jYWxsKHksIG9wWzFdKSkuZG9uZSkgcmV0dXJuIHQ7XHJcbiAgICAgICAgICAgIGlmICh5ID0gMCwgdCkgb3AgPSBbb3BbMF0gJiAyLCB0LnZhbHVlXTtcclxuICAgICAgICAgICAgc3dpdGNoIChvcFswXSkge1xyXG4gICAgICAgICAgICAgICAgY2FzZSAwOiBjYXNlIDE6IHQgPSBvcDsgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICBjYXNlIDQ6IF8ubGFiZWwrKzsgcmV0dXJuIHsgdmFsdWU6IG9wWzFdLCBkb25lOiBmYWxzZSB9O1xyXG4gICAgICAgICAgICAgICAgY2FzZSA1OiBfLmxhYmVsKys7IHkgPSBvcFsxXTsgb3AgPSBbMF07IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgY2FzZSA3OiBvcCA9IF8ub3BzLnBvcCgpOyBfLnRyeXMucG9wKCk7IGNvbnRpbnVlO1xyXG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgICAgICBpZiAoISh0ID0gXy50cnlzLCB0ID0gdC5sZW5ndGggPiAwICYmIHRbdC5sZW5ndGggLSAxXSkgJiYgKG9wWzBdID09PSA2IHx8IG9wWzBdID09PSAyKSkgeyBfID0gMDsgY29udGludWU7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAob3BbMF0gPT09IDMgJiYgKCF0IHx8IChvcFsxXSA+IHRbMF0gJiYgb3BbMV0gPCB0WzNdKSkpIHsgXy5sYWJlbCA9IG9wWzFdOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChvcFswXSA9PT0gNiAmJiBfLmxhYmVsIDwgdFsxXSkgeyBfLmxhYmVsID0gdFsxXTsgdCA9IG9wOyBicmVhazsgfVxyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0ICYmIF8ubGFiZWwgPCB0WzJdKSB7IF8ubGFiZWwgPSB0WzJdOyBfLm9wcy5wdXNoKG9wKTsgYnJlYWs7IH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAodFsyXSkgXy5vcHMucG9wKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgXy50cnlzLnBvcCgpOyBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBvcCA9IGJvZHkuY2FsbCh0aGlzQXJnLCBfKTtcclxuICAgICAgICB9IGNhdGNoIChlKSB7IG9wID0gWzYsIGVdOyB5ID0gMDsgfSBmaW5hbGx5IHsgZiA9IHQgPSAwOyB9XHJcbiAgICAgICAgaWYgKG9wWzBdICYgNSkgdGhyb3cgb3BbMV07IHJldHVybiB7IHZhbHVlOiBvcFswXSA/IG9wWzFdIDogdm9pZCAwLCBkb25lOiB0cnVlIH07XHJcbiAgICB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2V4cG9ydFN0YXIobSwgZXhwb3J0cykge1xyXG4gICAgZm9yICh2YXIgcCBpbiBtKSBpZiAoIWV4cG9ydHMuaGFzT3duUHJvcGVydHkocCkpIGV4cG9ydHNbcF0gPSBtW3BdO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX192YWx1ZXMobykge1xyXG4gICAgdmFyIG0gPSB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb1tTeW1ib2wuaXRlcmF0b3JdLCBpID0gMDtcclxuICAgIGlmIChtKSByZXR1cm4gbS5jYWxsKG8pO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICBuZXh0OiBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmIChvICYmIGkgPj0gby5sZW5ndGgpIG8gPSB2b2lkIDA7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHZhbHVlOiBvICYmIG9baSsrXSwgZG9uZTogIW8gfTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19yZWFkKG8sIG4pIHtcclxuICAgIHZhciBtID0gdHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIG9bU3ltYm9sLml0ZXJhdG9yXTtcclxuICAgIGlmICghbSkgcmV0dXJuIG87XHJcbiAgICB2YXIgaSA9IG0uY2FsbChvKSwgciwgYXIgPSBbXSwgZTtcclxuICAgIHRyeSB7XHJcbiAgICAgICAgd2hpbGUgKChuID09PSB2b2lkIDAgfHwgbi0tID4gMCkgJiYgIShyID0gaS5uZXh0KCkpLmRvbmUpIGFyLnB1c2goci52YWx1ZSk7XHJcbiAgICB9XHJcbiAgICBjYXRjaCAoZXJyb3IpIHsgZSA9IHsgZXJyb3I6IGVycm9yIH07IH1cclxuICAgIGZpbmFsbHkge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmIChyICYmICFyLmRvbmUgJiYgKG0gPSBpW1wicmV0dXJuXCJdKSkgbS5jYWxsKGkpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBmaW5hbGx5IHsgaWYgKGUpIHRocm93IGUuZXJyb3I7IH1cclxuICAgIH1cclxuICAgIHJldHVybiBhcjtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fc3ByZWFkKCkge1xyXG4gICAgZm9yICh2YXIgYXIgPSBbXSwgaSA9IDA7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKyspXHJcbiAgICAgICAgYXIgPSBhci5jb25jYXQoX19yZWFkKGFyZ3VtZW50c1tpXSkpO1xyXG4gICAgcmV0dXJuIGFyO1xyXG59XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19hd2FpdCh2KSB7XHJcbiAgICByZXR1cm4gdGhpcyBpbnN0YW5jZW9mIF9fYXdhaXQgPyAodGhpcy52ID0gdiwgdGhpcykgOiBuZXcgX19hd2FpdCh2KTtcclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNHZW5lcmF0b3IodGhpc0FyZywgX2FyZ3VtZW50cywgZ2VuZXJhdG9yKSB7XHJcbiAgICBpZiAoIVN5bWJvbC5hc3luY0l0ZXJhdG9yKSB0aHJvdyBuZXcgVHlwZUVycm9yKFwiU3ltYm9sLmFzeW5jSXRlcmF0b3IgaXMgbm90IGRlZmluZWQuXCIpO1xyXG4gICAgdmFyIGcgPSBnZW5lcmF0b3IuYXBwbHkodGhpc0FyZywgX2FyZ3VtZW50cyB8fCBbXSksIGksIHEgPSBbXTtcclxuICAgIHJldHVybiBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobikgeyBpZiAoZ1tuXSkgaVtuXSA9IGZ1bmN0aW9uICh2KSB7IHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAoYSwgYikgeyBxLnB1c2goW24sIHYsIGEsIGJdKSA+IDEgfHwgcmVzdW1lKG4sIHYpOyB9KTsgfTsgfVxyXG4gICAgZnVuY3Rpb24gcmVzdW1lKG4sIHYpIHsgdHJ5IHsgc3RlcChnW25dKHYpKTsgfSBjYXRjaCAoZSkgeyBzZXR0bGUocVswXVszXSwgZSk7IH0gfVxyXG4gICAgZnVuY3Rpb24gc3RlcChyKSB7IHIudmFsdWUgaW5zdGFuY2VvZiBfX2F3YWl0ID8gUHJvbWlzZS5yZXNvbHZlKHIudmFsdWUudikudGhlbihmdWxmaWxsLCByZWplY3QpIDogc2V0dGxlKHFbMF1bMl0sIHIpOyB9XHJcbiAgICBmdW5jdGlvbiBmdWxmaWxsKHZhbHVlKSB7IHJlc3VtZShcIm5leHRcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiByZWplY3QodmFsdWUpIHsgcmVzdW1lKFwidGhyb3dcIiwgdmFsdWUpOyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUoZiwgdikgeyBpZiAoZih2KSwgcS5zaGlmdCgpLCBxLmxlbmd0aCkgcmVzdW1lKHFbMF1bMF0sIHFbMF1bMV0pOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2FzeW5jRGVsZWdhdG9yKG8pIHtcclxuICAgIHZhciBpLCBwO1xyXG4gICAgcmV0dXJuIGkgPSB7fSwgdmVyYihcIm5leHRcIiksIHZlcmIoXCJ0aHJvd1wiLCBmdW5jdGlvbiAoZSkgeyB0aHJvdyBlOyB9KSwgdmVyYihcInJldHVyblwiKSwgaVtTeW1ib2wuaXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaTtcclxuICAgIGZ1bmN0aW9uIHZlcmIobiwgZikgeyBpW25dID0gb1tuXSA/IGZ1bmN0aW9uICh2KSB7IHJldHVybiAocCA9ICFwKSA/IHsgdmFsdWU6IF9fYXdhaXQob1tuXSh2KSksIGRvbmU6IG4gPT09IFwicmV0dXJuXCIgfSA6IGYgPyBmKHYpIDogdjsgfSA6IGY7IH1cclxufVxyXG5cclxuZXhwb3J0IGZ1bmN0aW9uIF9fYXN5bmNWYWx1ZXMobykge1xyXG4gICAgaWYgKCFTeW1ib2wuYXN5bmNJdGVyYXRvcikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlN5bWJvbC5hc3luY0l0ZXJhdG9yIGlzIG5vdCBkZWZpbmVkLlwiKTtcclxuICAgIHZhciBtID0gb1tTeW1ib2wuYXN5bmNJdGVyYXRvcl0sIGk7XHJcbiAgICByZXR1cm4gbSA/IG0uY2FsbChvKSA6IChvID0gdHlwZW9mIF9fdmFsdWVzID09PSBcImZ1bmN0aW9uXCIgPyBfX3ZhbHVlcyhvKSA6IG9bU3ltYm9sLml0ZXJhdG9yXSgpLCBpID0ge30sIHZlcmIoXCJuZXh0XCIpLCB2ZXJiKFwidGhyb3dcIiksIHZlcmIoXCJyZXR1cm5cIiksIGlbU3ltYm9sLmFzeW5jSXRlcmF0b3JdID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gdGhpczsgfSwgaSk7XHJcbiAgICBmdW5jdGlvbiB2ZXJiKG4pIHsgaVtuXSA9IG9bbl0gJiYgZnVuY3Rpb24gKHYpIHsgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsgdiA9IG9bbl0odiksIHNldHRsZShyZXNvbHZlLCByZWplY3QsIHYuZG9uZSwgdi52YWx1ZSk7IH0pOyB9OyB9XHJcbiAgICBmdW5jdGlvbiBzZXR0bGUocmVzb2x2ZSwgcmVqZWN0LCBkLCB2KSB7IFByb21pc2UucmVzb2x2ZSh2KS50aGVuKGZ1bmN0aW9uKHYpIHsgcmVzb2x2ZSh7IHZhbHVlOiB2LCBkb25lOiBkIH0pOyB9LCByZWplY3QpOyB9XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX21ha2VUZW1wbGF0ZU9iamVjdChjb29rZWQsIHJhdykge1xyXG4gICAgaWYgKE9iamVjdC5kZWZpbmVQcm9wZXJ0eSkgeyBPYmplY3QuZGVmaW5lUHJvcGVydHkoY29va2VkLCBcInJhd1wiLCB7IHZhbHVlOiByYXcgfSk7IH0gZWxzZSB7IGNvb2tlZC5yYXcgPSByYXc7IH1cclxuICAgIHJldHVybiBjb29rZWQ7XHJcbn07XHJcblxyXG5leHBvcnQgZnVuY3Rpb24gX19pbXBvcnRTdGFyKG1vZCkge1xyXG4gICAgaWYgKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgcmV0dXJuIG1vZDtcclxuICAgIHZhciByZXN1bHQgPSB7fTtcclxuICAgIGlmIChtb2QgIT0gbnVsbCkgZm9yICh2YXIgayBpbiBtb2QpIGlmIChPYmplY3QuaGFzT3duUHJvcGVydHkuY2FsbChtb2QsIGspKSByZXN1bHRba10gPSBtb2Rba107XHJcbiAgICByZXN1bHQuZGVmYXVsdCA9IG1vZDtcclxuICAgIHJldHVybiByZXN1bHQ7XHJcbn1cclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBfX2ltcG9ydERlZmF1bHQobW9kKSB7XHJcbiAgICByZXR1cm4gKG1vZCAmJiBtb2QuX19lc01vZHVsZSkgPyBtb2QgOiB7IGRlZmF1bHQ6IG1vZCB9O1xyXG59XHJcbiIsImltcG9ydCB7SW5qZWN0YWJsZX0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQge0Fwb2xsb0xpbmssIE9ic2VydmFibGV9IGZyb20gJ2Fwb2xsby1saW5rJztcbmltcG9ydCB7QXBvbGxvfSBmcm9tICdhcG9sbG8tYW5ndWxhcic7XG5pbXBvcnQge0h0dHBMaW5rfSBmcm9tICdhcG9sbG8tYW5ndWxhci1saW5rLWh0dHAnO1xuaW1wb3J0IHt3aXRoQ2xpZW50U3RhdGV9IGZyb20gJ2Fwb2xsby1saW5rLXN0YXRlJztcbmltcG9ydCB7b25FcnJvcn0gZnJvbSAnYXBvbGxvLWxpbmstZXJyb3InO1xuaW1wb3J0IHtJbk1lbW9yeUNhY2hlfSBmcm9tICdhcG9sbG8tY2FjaGUtaW5tZW1vcnknO1xuXG5pbXBvcnQge1ByZXNldENvbmZpZ30gZnJvbSAnLi90eXBlcyc7XG5cbkBJbmplY3RhYmxlKClcbmV4cG9ydCBjbGFzcyBBcG9sbG9Cb29zdCB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgYXBvbGxvOiBBcG9sbG8sIHByaXZhdGUgaHR0cExpbms6IEh0dHBMaW5rKSB7fVxuXG4gIHB1YmxpYyBjcmVhdGUoY29uZmlnOiBQcmVzZXRDb25maWcpIHtcbiAgICBjb25zdCBjYWNoZSA9XG4gICAgICBjb25maWcgJiYgY29uZmlnLmNhY2hlUmVkaXJlY3RzXG4gICAgICAgID8gbmV3IEluTWVtb3J5Q2FjaGUoe2NhY2hlUmVkaXJlY3RzOiBjb25maWcuY2FjaGVSZWRpcmVjdHN9KVxuICAgICAgICA6IG5ldyBJbk1lbW9yeUNhY2hlKCk7XG5cbiAgICBjb25zdCBzdGF0ZUxpbmsgPVxuICAgICAgY29uZmlnICYmIGNvbmZpZy5jbGllbnRTdGF0ZVxuICAgICAgICA/IHdpdGhDbGllbnRTdGF0ZSh7Li4uY29uZmlnLmNsaWVudFN0YXRlLCBjYWNoZX0pXG4gICAgICAgIDogZmFsc2U7XG5cbiAgICBjb25zdCBlcnJvckxpbmsgPVxuICAgICAgY29uZmlnICYmIGNvbmZpZy5vbkVycm9yXG4gICAgICAgID8gb25FcnJvcihjb25maWcub25FcnJvcilcbiAgICAgICAgOiBvbkVycm9yKCh7Z3JhcGhRTEVycm9ycywgbmV0d29ya0Vycm9yfSkgPT4ge1xuICAgICAgICAgICAgaWYgKGdyYXBoUUxFcnJvcnMpIHtcbiAgICAgICAgICAgICAgZ3JhcGhRTEVycm9ycy5tYXAoKHttZXNzYWdlLCBsb2NhdGlvbnMsIHBhdGh9KSA9PlxuICAgICAgICAgICAgICAgIC8vIHRzbGludDpkaXNhYmxlLW5leHQtbGluZVxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKFxuICAgICAgICAgICAgICAgICAgYFtHcmFwaFFMIGVycm9yXTogTWVzc2FnZTogJHttZXNzYWdlfSwgTG9jYXRpb246ICR7bG9jYXRpb25zfSwgUGF0aDogJHtwYXRofWAsXG4gICAgICAgICAgICAgICAgKSxcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChuZXR3b3JrRXJyb3IpIHtcbiAgICAgICAgICAgICAgLy8gdHNsaW50OmRpc2FibGUtbmV4dC1saW5lXG4gICAgICAgICAgICAgIGNvbnNvbGUubG9nKGBbTmV0d29yayBlcnJvcl06ICR7bmV0d29ya0Vycm9yfWApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuXG4gICAgY29uc3QgcmVxdWVzdEhhbmRsZXIgPVxuICAgICAgY29uZmlnICYmIGNvbmZpZy5yZXF1ZXN0XG4gICAgICAgID8gbmV3IEFwb2xsb0xpbmsoXG4gICAgICAgICAgICAob3BlcmF0aW9uLCBmb3J3YXJkKSA9PlxuICAgICAgICAgICAgICBuZXcgT2JzZXJ2YWJsZShvYnNlcnZlciA9PiB7XG4gICAgICAgICAgICAgICAgbGV0IGhhbmRsZTogYW55O1xuICAgICAgICAgICAgICAgIFByb21pc2UucmVzb2x2ZShvcGVyYXRpb24pXG4gICAgICAgICAgICAgICAgICAudGhlbihvcGVyID0+IGNvbmZpZy5yZXF1ZXN0KG9wZXIpKVxuICAgICAgICAgICAgICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGUgPSBmb3J3YXJkKG9wZXJhdGlvbikuc3Vic2NyaWJlKHtcbiAgICAgICAgICAgICAgICAgICAgICBuZXh0OiBvYnNlcnZlci5uZXh0LmJpbmQob2JzZXJ2ZXIpLFxuICAgICAgICAgICAgICAgICAgICAgIGVycm9yOiBvYnNlcnZlci5lcnJvci5iaW5kKG9ic2VydmVyKSxcbiAgICAgICAgICAgICAgICAgICAgICBjb21wbGV0ZTogb2JzZXJ2ZXIuY29tcGxldGUuYmluZChvYnNlcnZlciksXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICAgIC5jYXRjaChvYnNlcnZlci5lcnJvci5iaW5kKG9ic2VydmVyKSk7XG5cbiAgICAgICAgICAgICAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgICAgICAgICAgICAgaWYgKGhhbmRsZSkge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGUudW5zdWJzY3JpYmUoKTtcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9O1xuICAgICAgICAgICAgICB9KSxcbiAgICAgICAgICApXG4gICAgICAgIDogZmFsc2U7XG5cbiAgICBjb25zdCBodHRwTGluayA9IHRoaXMuaHR0cExpbmsuY3JlYXRlKHtcbiAgICAgIC4uLigoY29uZmlnICYmIGNvbmZpZy5odHRwT3B0aW9ucykgfHwge30pLFxuICAgICAgdXJpOiAoY29uZmlnICYmIGNvbmZpZy51cmkpIHx8ICcvZ3JhcGhxbCcsXG4gICAgfSk7XG5cbiAgICBjb25zdCBsaW5rID0gQXBvbGxvTGluay5mcm9tKFtcbiAgICAgIGVycm9yTGluayxcbiAgICAgIHJlcXVlc3RIYW5kbGVyLFxuICAgICAgc3RhdGVMaW5rLFxuICAgICAgaHR0cExpbmssXG4gICAgXS5maWx0ZXIoeCA9PiAhIXgpIGFzIEFwb2xsb0xpbmtbXSk7XG5cbiAgICB0aGlzLmFwb2xsby5jcmVhdGUoe1xuICAgICAgbGluayxcbiAgICAgIGNhY2hlLFxuICAgIH0pO1xuICB9XG59XG4iLCJpbXBvcnQge05nTW9kdWxlLCBPcHRpb25hbCwgSW5qZWN0fSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7QXBvbGxvTW9kdWxlfSBmcm9tICdhcG9sbG8tYW5ndWxhcic7XG5pbXBvcnQge0h0dHBMaW5rTW9kdWxlfSBmcm9tICdhcG9sbG8tYW5ndWxhci1saW5rLWh0dHAnO1xuXG5pbXBvcnQge0Fwb2xsb0Jvb3N0fSBmcm9tICcuL0Fwb2xsb0Jvb3N0JztcbmltcG9ydCB7QVBPTExPX0JPT1NUX0NPTkZJR30gZnJvbSAnLi90b2tlbnMnO1xuaW1wb3J0IHtQcmVzZXRDb25maWd9IGZyb20gJy4vdHlwZXMnO1xuXG5ATmdNb2R1bGUoe1xuICBpbXBvcnRzOiBbQXBvbGxvTW9kdWxlLCBIdHRwTGlua01vZHVsZV0sXG4gIHByb3ZpZGVyczogW0Fwb2xsb0Jvb3N0XSxcbn0pXG5leHBvcnQgY2xhc3MgQXBvbGxvQm9vc3RNb2R1bGUge1xuICBjb25zdHJ1Y3RvcihcbiAgICBib29zdDogQXBvbGxvQm9vc3QsXG4gICAgQE9wdGlvbmFsKClcbiAgICBASW5qZWN0KEFQT0xMT19CT09TVF9DT05GSUcpXG4gICAgY29uZmlnPzogUHJlc2V0Q29uZmlnLFxuICApIHtcbiAgICBpZiAoY29uZmlnKSB7XG4gICAgICBib29zdC5jcmVhdGUoY29uZmlnKTtcbiAgICB9XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJJbmplY3Rpb25Ub2tlbiIsIkluTWVtb3J5Q2FjaGUiLCJ3aXRoQ2xpZW50U3RhdGUiLCJvbkVycm9yIiwiQXBvbGxvTGluayIsIk9ic2VydmFibGUiLCJJbmplY3RhYmxlIiwiQXBvbGxvIiwiSHR0cExpbmsiLCJOZ01vZHVsZSIsIkFwb2xsb01vZHVsZSIsIkh0dHBMaW5rTW9kdWxlIiwiT3B0aW9uYWwiLCJJbmplY3Qi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